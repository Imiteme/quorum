<div id="show">
  <h1>Search Results</h1>
  <p class="small right"><%= link_to raw("Search Again &raquo;"), :jobs %></p>
  <div id="tabs">
    <ul>
      <li><a href="#tabs-1">Blastn</a></li>
      <li><a href="#tabs-2">Blastx</a></li>
      <li><a href="#tabs-3">Tblastn</a></li>
      <li><a href="#tabs-4">Blastp</a></li>
      <li><a href="#tabs-5">Hmmer</a></li>
    </ul>
    
    <div id="tabs-1">
      <h2>Blastn</h2>
      <div id="blastn-results">
        Searching... <%= image_tag "quorum/knight_rider.gif" %> 
      </div>
    </div>

    <div id="tabs-2">
      <h2>Blastx</h2>
      <div id="blastx-results">
        Searching... <%= image_tag "quorum/knight_rider.gif" %> 
      </div>
    </div>

    <div id="tabs-3">
      <h2>Tblastn</h2>
      <div id="tblastn-results">
        Searching... <%= image_tag "quorum/knight_rider.gif" %> 
      </div>
    </div>

    <div id="tabs-4">
      <h2>Blastp</h2>
      <div id="blastp-results">
        Searching... <%= image_tag "quorum/knight_rider.gif" %> 
      </div>
    </div>

    <div id="tabs-5">
      <h2>Hmmer</h2>
      <div id="hmmer-results">
      </div>
    </div>
  </div>
  <p class="small right"><%= link_to raw("Search Again &raquo;"), :jobs %></p>
</div>

<script type="text/template" id="blast_template">
  {{ if (data[0].results === false) { }}
    <p><strong>Your search returned 0 hits.</strong></p>
  {{ } else { }}
	  <table class="report_details">
	    <tr>
	      <th>Query ID</th>
	      <th>Query Length</th>
	      <th>Hit ID</th>
	      <th>Hit Length</th>
	      <th>Hit Description</th>
	      <th>Alignment Length</th>
	      <th>Bit Score</th>
	      <th>E-value</th>
	    </tr>
	    {{ var i = 1; var style = "" }}
	    {{ _.each(data, function(v) { }}
	      {{ i % 2 == 0 ? style = "even" : style = "odd" }}
	      <tr class="{{= style }}">
	        <td>{{= v.query }}</td>
	        <td>{{= v.query_len }}</td>
	        <td>{{= v.hit_id }}</td>
	        <td>{{= v.hit_len }}</td>
	        <td></td>
	        <td>{{= v.align_len }}</td>
	        <td>{{= v.bit_score }}</td>
	        <td>{{= v.evalue }}</td>
	      </tr>
	      {{ i++ }}
	    {{ }); }}
	  </table>
  {{ } }}
</script>

<script type="text/javascript">
  $(function() {
    pollResults(<%= @jobs.id %>, "blastn");
    pollResults(<%= @jobs.id %>, "blastx");
    pollResults(<%= @jobs.id %>, "tblastn");
    pollResults(<%= @jobs.id %>, "blastp");
    //pollResults(<%= @jobs.id %>, "hmmer");
  });
</script>
